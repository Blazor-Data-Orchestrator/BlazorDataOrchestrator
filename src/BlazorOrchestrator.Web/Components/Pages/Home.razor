@page "/"
@using Radzen
@using Radzen.Blazor

<PageTitle>Dashboard</PageTitle>

<RadzenStack Gap="1.5rem">
    <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.5rem">
        <RadzenIcon Icon="assignment" Style="font-size: 1.5rem;" />
        <RadzenText TextStyle="TextStyle.H4" TagName="TagName.H1" Style="margin: 0;">Status of all running jobs</RadzenText>
    </RadzenStack>

    <RadzenStack Orientation="Orientation.Horizontal" Gap="0.5rem">
        <RadzenButton Text="Upload .NuGet" ButtonStyle="ButtonStyle.Light" Variant="Variant.Outlined" />
        <RadzenButton Text="Create New Job" ButtonStyle="ButtonStyle.Primary" />
    </RadzenStack>

    <RadzenRow Gap="1rem">
        @foreach (var job in Jobs)
        {
            <RadzenColumn Size="12" SizeMD="6" SizeLG="4">
                <RadzenCard Style="padding: 1.5rem;">
                    <RadzenStack Gap="1rem">
                        <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.SpaceBetween" AlignItems="AlignItems.Center">
                            <RadzenText TextStyle="TextStyle.H6" TagName="TagName.H3" Style="margin: 0; font-weight: 600;">@job.Name</RadzenText>
                            <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.25rem">
                                <span style="@($"width: 8px; height: 8px; border-radius: 50%; background-color: {(job.IsRunning ? "#22c55e" : "#6b7280")};")"></span>
                                <RadzenText TextStyle="TextStyle.Body2" Style="@($"color: {(job.IsRunning ? "#22c55e" : "#6b7280")}; margin: 0;")">
                                    @(job.IsRunning ? "Running" : "Stopped")
                                </RadzenText>
                            </RadzenStack>
                        </RadzenStack>

                        <RadzenStack Orientation="Orientation.Horizontal" Gap="2rem">
                            <RadzenStack Gap="0.25rem">
                                <RadzenText TextStyle="TextStyle.Caption" Style="color: #6b7280; margin: 0;">Last run</RadzenText>
                                <RadzenText TextStyle="TextStyle.Body2" Style="margin: 0;">@job.LastRun</RadzenText>
                            </RadzenStack>
                            <RadzenStack Gap="0.25rem">
                                <RadzenText TextStyle="TextStyle.Caption" Style="color: #6b7280; margin: 0;">Next run</RadzenText>
                                <RadzenText TextStyle="TextStyle.Body2" Style="margin: 0;">@job.NextRun</RadzenText>
                            </RadzenStack>
                        </RadzenStack>

                        <RadzenStack Orientation="Orientation.Horizontal" Gap="0.5rem" Wrap="FlexWrap.Wrap" AlignItems="AlignItems.Center">
                            <RadzenButton Text="Edit" ButtonStyle="ButtonStyle.Primary" Size="ButtonSize.Small" />
                            <RadzenButton Text="Schedule" ButtonStyle="ButtonStyle.Success" Size="ButtonSize.Small" />
                            @if (job.IsRunning)
                            {
                                <RadzenButton Text="Run Now" ButtonStyle="ButtonStyle.Base" Variant="Variant.Outlined" Size="ButtonSize.Small" />
                                <RadzenButton Text="Stop" ButtonStyle="ButtonStyle.Danger" Variant="Variant.Outlined" Size="ButtonSize.Small" />
                                <RadzenButton Text="Logs" ButtonStyle="ButtonStyle.Base" Variant="Variant.Text" Size="ButtonSize.Small" Style="color: #6b7280;" />
                            }
                            else
                            {
                                <RadzenButton Text="Start" ButtonStyle="ButtonStyle.Success" Size="ButtonSize.Small" />
                                <RadzenButton Text="Logs" ButtonStyle="ButtonStyle.Base" Variant="Variant.Text" Size="ButtonSize.Small" Style="color: #6b7280;" />
                            }
                        </RadzenStack>
                    </RadzenStack>
                </RadzenCard>
            </RadzenColumn>
        }
    </RadzenRow>
</RadzenStack>

@code {
    private List<JobViewModel> Jobs { get; set; } = new();

    protected override void OnInitialized()
    {
        // Sample data matching the screenshot
        Jobs = new List<JobViewModel>
        {
            new JobViewModel
            {
                Name = "Nightly Import – HR",
                IsRunning = true,
                LastRun = "Today 02:00",
                NextRun = "Tomorrow 02:00"
            },
            new JobViewModel
            {
                Name = "Generate Forecasts",
                IsRunning = false,
                LastRun = "Yesterday 03:13",
                NextRun = "Today 03:00"
            },
            new JobViewModel
            {
                Name = "Sync Attachments",
                IsRunning = true,
                LastRun = "Today 01:10",
                NextRun = "Today 05:10"
            }
        };
    }

    private class JobViewModel
    {
        public string Name { get; set; } = string.Empty;
        public bool IsRunning { get; set; }
        public string LastRun { get; set; } = string.Empty;
        public string NextRun { get; set; } = string.Empty;
    }
}
